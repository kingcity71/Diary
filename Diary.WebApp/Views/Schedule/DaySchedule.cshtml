@using Diary.Models;

@model Diary.WebApp.Models.ScheduleDayViewModel;
@{
    var ADMIN_ROLE = "Admin";
    var STUDENT_ROLE = "Student";
    var PARENT_ROLE = "Parent";
    var TEACHER_ROLE = "Teacher";

    var EMPTY_TIME = "Занятия нет";

    ViewData["Title"] = "DaySchedule";
    var dateTimeStart = Model.Date.Date.AddHours(9);

    var dateTimeEnd = Model.Date.Date.AddHours(16);
    

    string getAdditionalInfo(ScheduleModel scheduleModel)
    {
        if(User.IsInRole(STUDENT_ROLE))
            return scheduleModel.Subject;

        if (User.IsInRole(TEACHER_ROLE))
            return scheduleModel.Class.FullName;

        if (User.IsInRole(PARENT_ROLE))
            return $"{scheduleModel.Subject}, {scheduleModel.Teacher}";

        return string.Empty;
    };
}

<h1>Расписание на @Model.Date.ToShortDateString()</h1>
@for(var dateTime = dateTimeStart; dateTime<dateTimeEnd; dateTime = dateTime.AddMinutes(45))
{
    var sched = Model.ScheduleModels.FirstOrDefault(x => x.Date == dateTime);
    <div data-hour="@dateTime.Hour" data-minute="@dateTime.Minute">@dateTime.ToShortTimeString() @(sched != null? getAdditionalInfo(sched) : EMPTY_TIME)</div>
}